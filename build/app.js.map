{"version":3,"sources":["../server/app.js"],"names":["db","corsOptions","origin","optionsSuccessStatus","connect","app","use","json","post","req","res","updateItemRate","body","department","rating","then","send","data","toString","addItemComment","count","text","console","log","get","listItems","name","listen"],"mappings":";;AAmBA;;;;AACA;;;;AACA;;IAAYA,E;;AACZ;;AACA;;;;AACA;;AAOA;;;;;;;;AA/BA;;;;;;;;;;;;;;;;;;AA0BA,IAAMC,cAAc;AAClBC,UAAQ,GADU;AAElBC,wBAAsB,GAFJ,CAES;AAFT,CAApB;;AAOA;AACAH,GAAGI,OAAH;AACA,2BAAYJ,EAAZ;;AAGA;AACA,IAAMK,MAAM,wBAAZ;AACAA,IAAIC,GAAJ,CAAQ,qBAAWC,IAAX,EAAR;AACAF,IAAIC,GAAJ,CAAQ,oBAAKL,WAAL,CAAR;;AAGAI,IAAIG,IAAJ,CAAS,aAAT,EAAwB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACpCV,KAAGW,cAAH,CAAkBF,IAAIG,IAAJ,CAASC,UAA3B,EAAuCJ,IAAIG,IAAJ,CAASE,MAAhD,EAAwDC,IAAxD,CAA6D;AAAA,WAAQL,IAAIM,IAAJ,CAASC,KAAKC,QAAL,EAAT,CAAR;AAAA,GAA7D;AACD,CAFD;;AAIAb,IAAIG,IAAJ,CAAS,cAAT,EAAyB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACrCV,KAAGmB,cAAH,CAAkBV,IAAIG,IAAJ,CAASC,UAA3B,EAAuCJ,IAAIG,IAAJ,CAASQ,KAAhD,EAAuDX,IAAIG,IAAJ,CAASS,IAAhE;AACDC,UAAQC,GAAR,CAAYd,IAAIG,IAAhB;AAEA,CAJD;;AAMAP,IAAImB,GAAJ,CAAQ,QAAR,EAAkB,UAACf,GAAD,EAAMC,GAAN,EAAc;AAC9BV,KAAGyB,SAAH,CAAa,EAAEC,MAAM,WAAR,EAAb,EAAoCX,IAApC,CAAyC,UAACE,IAAD,EAAU;AACjDP,QAAIM,IAAJ,CAAS,wBAASC,KAAK,CAAL,CAAT,CAAT;AACD,GAFD;AAGD,CAJD;;AAMAZ,IAAImB,GAAJ,CAAQ,GAAR,EAAa,UAACf,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIM,IAAJ,CAAS,IAAT;AACA,CAFD;;AAIAX,IAAIsB,MAAJ,qBAAuB,YAAM;AAC3BL,UAAQC,GAAR;AACD,CAFD;;;;;;;;gCAtCMtB,W;;gCAaAI,G","file":"app.js","sourcesContent":["/*\n * Steps\n 1. init\n 2. express\n 3. babel sudo npm i -g babel-cli\n 4. mongo\n tar -zxvf mongodb-osx-ssl-x86_64-3.4.5.tgz\n mkdir -p /Users/Juff/Documents/mongodb\n cp -R -n mongodb-osx-x86_64-3.4.5/ /Users/Juff/Documents/mongodb/\n export PATH=/Users/Juff/Documents/mongodb/bin:$PATH\n mkdir -p /Users/Juff/Documents/mongodb/data/db/\n mongod --dbpath /Users/Juff/Documents/mongodb/data/db/\n robomongo\n mongoose\n 5. body-parser\n\n */\n\n\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport * as db from './utils/dbutils';\nimport { serverPort } from './config/config.json';\nimport cors from 'cors';\nimport { sendStat } from './utils/sendStat';\n\nconst corsOptions = {\n  origin: '*',\n  optionsSuccessStatus: 200, // some legacy browsers (IE11, various SmartTVs) choke on 204\n};\n\nimport createItems from './utils/createItems';\n\n// Connect to DB\ndb.connect();\ncreateItems(db);\n\n\n// Create and start server\nconst app = express();\napp.use(bodyParser.json());\napp.use(cors(corsOptions));\n\n\napp.post('/updateRate', (req, res) => {\n  db.updateItemRate(req.body.department, req.body.rating).then(data => res.send(data.toString()));\n});\n\napp.post('/sendComment', (req, res) => {\n  db.addItemComment(req.body.department, req.body.count, req.body.text);\n console.log(req.body);\n\n});\n\napp.get('/admin', (req, res) => {\n  db.listItems({ name: 'Secretary' }).then((data) => {\n    res.send(sendStat(data[0]));\n  });\n});\n\napp.get('/', (req, res) => {\n res.send('OK');\n});\n\napp.listen(serverPort, () => {\n  console.log(`Server is running on ${serverPort}`);\n});\n"]}